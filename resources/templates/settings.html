<html>
    <head>
        {{{cspBlob}}}
        <style>
            {{{cssBlob}}}
        </style>
    </head>

    <body>
        <div class="container">
            <div class="row">
                <div class="col">
                    <h1>TMC Settings</h1>
                    <p>
                        Here you can change TMC extension settings. <br />
                        Settings are saved automatically.
                    </p>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <div class="card-transparent border-color my-1">
                        <div class="card-body">
                            <h5 class="card-title">TMC Data</h5>
                            <p class="card-text">
                                Currently your TMC data ({{tmcDataSize}}) is located at: <br />
                                <span class="text-break">{{extensionSettings.dataPath}}</span>
                            </p>
                            <button class="btn btn-primary" onclick="changeTmcDataPath()">
                                Change path
                            </button>
                        </div>
                    </div>
                    <div class="card-transparent border-color my-1">
                        <div class="card-body">
                            <h5 class="card-title">Extension logging</h5>
                            <p class="card-text">
                                <label for="log-level">Choose log level:</label>
                                <select id="log-level">
                                    <option selected>
                                        Current: {{extensionSettings.logLevel}}
                                    </option>
                                    <option value="none">none</option>
                                    <option value="errors">errors</option>
                                    <option value="verbose">verbose</option>
                                </select>
                            </p>
                        </div>
                    </div>
                    <div class="card-transparent border-color my-1">
                        <div class="card-body">
                            <h5 class="card-title">Hide Exercise Meta files</h5>
                            <p class="card-text">
                                Hides exercise meta files, i.e. .available_points.json,
                                .tmc_test_result.json, tmc, __pycache__, etc.
                            </p>
                            <div class="custom-control custom-switch">
                                <input
                                    type="checkbox"
                                    onclick="hideMetaFiles()"
                                    class="custom-control-input"
                                    id="check-meta-files"
                                />
                                <label class="custom-control-label" for="check-meta-files"
                                    >Toggle to hide</label
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            const vscode = acquireVsCodeApi();
            const metaFile = {{extensionSettings.hideMetaFiles}};
            function changeTmcDataPath() {
                vscode.postMessage({ type: "changeTmcDataPath" });
            }

            const element = document.getElementById("log-level");
            element.addEventListener("change", function () {
                const element = document.getElementById("log-level");
                if (element.selectedIndex !== 0) {
                    const level = element.options[element.selectedIndex].value;
                    vscode.postMessage({ type: "changeLogLevel", data: level });
                }
            });

            if (metaFile) {
                document.getElementById("check-meta-files").checked = true;
            }
            function hideMetaFiles() {
                const checkbox = document.getElementById("check-meta-files");
                vscode.postMessage({ type: "hideMetaFiles", data: checkbox.checked });
            }
        </script>
    </body>
</html>
